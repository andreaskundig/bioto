<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <script src="jquery-1.4.4.min.js"></script>
  <link rel="stylesheet" href="qunit.css" type="text/css" media="screen" />
<script type="text/javascript" src="qunit.js"></script>
<script type="text/javascript" src="bio.js"></script>

  <script>
  $(document).ready(function(){

  var text = {text: "En 2001, <elle:pronom_feminin> vient avec <Christophe:nom_masculin_2>. La prestation de <Loana:nom_feminin_1> est pas mal.",
 placeholders:[["Loana", "nom_feminin_1"], 
	  ["Christophe", "nom_masculin_2"], ["elle", "pronom_feminin"]] };
  

 test("build_paragraph",function() {
    var text = {text: "En 2001, <Loana:nom_feminin_1> vient.",
	    placeholders:[["Loana", "nom_feminin_1"]] };
    replaced = build_paragraph (text,["aaa","bb"]);

    equal(replaced,"En 2001, <span class=\"r\" style=\"display:inline-block;\">aaa</span><span class=\"o\" style=\"display:inline-block;\">Loana</span> vient.");
   
 });

 test("overlap", function(){
    var text = {text: "En 2001, <Loana:nom_feminin_1> vient.",
	    placeholders:[["Loana", "nom_feminin_1"]] };
    var pholder = text.placeholders[0];
    var torep = "<"+pholder[0]+":"+pholder[1]+">";
    equal(torep,"<Loana:nom_feminin_1>");
    var from = pholder[0];
    var to = "Bobo";
    equal(overlap("Loana","Bobo",0,true),"Loana");
    equal(overlap("Loana","Bobo",1,true),"LoanB");
    equal(overlap("Loana","Bobo",2,true),"LoaBo");
    equal(overlap("Loana","Bobo",3,true),"LoBob");
    equal(overlap("Loana","Bobo",4,true),"LBobo");
    equal(overlap("Loana","Bobo",5,true),"Bobo");

    equal(overlap("Lo","Bobo",0,true),"Lo");
    equal(overlap("Lo","Bobo",1,true),"LoB");
    equal(overlap("Lo","Bobo",2,true),"LoBo");
    equal(overlap("Lo","Bobo",3,true),"LBob");
    equal(overlap("Lo","Bobo",4,true),"Bobo");

    equal(overlap("Loana","Bobo",0,false),"Bobo");
    equal(overlap("Loana","Bobo",1,false),"LBobo");
    equal(overlap("Loana","Bobo",2,false),"LoBob");
    equal(overlap("Loana","Bobo",3,false),"LoaBo");
    equal(overlap("Loana","Bobo",4,false),"LoanB");
    equal(overlap("Loana","Bobo",5,false),"Loana");

 });
 
 test("span_words",function(){
   var text = span_words("En 01, <span class='o'>Loa na</span> vient sf<span> ah ah </span>bof. <br>hop");
   equal(text,
"<span style=\"display:inline-block;\">En&nbsp;</span><span style=\"display:inline-block;\">01,&nbsp;</span><span class='o'>Loa na</span><span style=\"display:inline-block;\">&nbsp;</span><span style=\"display:inline-block;\">vient&nbsp;</span><span style=\"display:inline-block;\">sf</span><span> ah ah </span><span style=\"display:inline-block;\">bof.&nbsp;</span><br><span style=\"display:inline-block;\">hop</span>");
 });
   
 test("map_placeholders", function() {
   var ph, map, nom_m;
   ph = [["Loana", "nom_feminin_1"], ["Christophe", "nom_masculin_2"], 
	  ["elle", "pronom_feminin"]];
   map = map_placeholders(ph,["a","b"]);
   deepEqual( map["nom_feminin_1"], "a", "");
   deepEqual( map["nom_masculin_2"], "b", "");
   deepEqual( map["pronom_feminin"], "elle", ""); 

   map = map_placeholders(ph,["a", "b", "c", "d"]);
   deepEqual( map["nom_feminin_1"], "a", "");
   nom_m = map["nom_masculin_2"];
   ok( $.inArray(nom_m, ["b", "c", "d"])>-1, "");
   deepEqual( map["pronom_feminin"], "elle", "");
 });

test("apostrophe_substitutions", function(){
 fixed = apostrophe_substitutions("le <raton:nom_masculin_3> mange", 
 "raton", "animal");
 equal(1,fixed.length);
 equal(fixed[0][1], "l'animal");
 equal(fixed[0][2], "le raton");

 fixed = apostrophe_substitutions("le <raton:nom_masculin> mange", 
 "raton", "animal");
 equal(1,fixed.length);
 equal(fixed[0][1], "l'animal");
 equal(fixed[0][2], "le raton");

 fixed = apostrophe_substitutions("le <raton (o):nom_masculin> mange", 
 "raton (o)", "animal");
 equal(1,fixed.length);
 equal(fixed[0][1], "l'animal");
 equal(fixed[0][2], "le raton (o)");

 fixed = apostrophe_substitutions("du <raton:nom_masculin>",
 "raton", "animal");
 equal(0,fixed.length);

 fixed = apostrophe_substitutions("l'<animal:nom_masculin_3> mange", 
                        "animal", "raton");
 equal(1,fixed.length);
 equal(fixed[0][1], "le raton");
 equal(fixed[0][2], "l'animal");

 fixed = apostrophe_substitutions("vénérable <animal:nom_masculin_3> me",
                        "animal", "raton");
 equal(0,fixed.length);

 fixed = apostrophe_substitutions("l'<animale:nom_feminin> mange", "animale",
				"ratonne");
 equal(1,fixed.length);
 equal(fixed[0][1], "la ratonne");
 equal(fixed[0][2], "l'animale");

 fixed = apostrophe_substitutions("qu'<animale:nom_feminin> mange", "animale",
				    "ratonne");
 equal(1,fixed.length);
 equal(fixed[0][1], "que ratonne");
 equal(fixed[0][2], "qu'animale");

});

});

  </script>
  
</head>
<body>
  <h1 id="qunit-header">QUnit example</h1>
 <h2 id="qunit-banner"></h2>
 <div id="qunit-testrunner-toolbar"></div>
 <h2 id="qunit-userAgent"></h2>
 <ol id="qunit-tests"></ol>
 <div id="qunit-fixture">test markup, will be hidden</div>
</body>
</html>
